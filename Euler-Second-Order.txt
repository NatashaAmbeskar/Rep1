'''
File Name: Euler's Second Order
Author: Natasha Ambeskar
Date: 5/22/2024

Description: Performs Euler's Method to approximate the solution to a second order differential equation. Method accepts parameters of second order differential equation(as a string), initial x and y values, initial y prime value, final x value, and step size

'''



from sympy import *
from math import *
init_printing(use_unicode=True)
x = Symbol("x")
y = Symbol("y")
yp = Symbol("yp") #represents y prime


#Parameters to be changed by user

eqn2='-1*y+-x*yp' #Second order differential equation as a string.
x0=0
y0=1
yp0=2             #initialy y prime value
xf=0.2
step=0.1




def EulersSecondOrder(eqn2,x0,y0,yp0,xf,step):  #Second order Euler's method 
    M=Matrix([[0,1]])
    CoeffList=[]
    for i in range(2):                         #Extracts coefficients from the equation and adds to a matrix
        var=eqn2.find("y")
        appending=sympify(eqn2[:var-1])
        CoeffList.append(appending)
        eqn2=eqn2[var+2:]
    M=M.row_insert(1,Matrix([CoeffList]))

    a=Matrix([y,yp])                           #Creates a new matrix to store y and y prime values

    iterations=int((xf-x0)/step)
    for i in range(iterations):                #Performs Euler's method on Matrix equation: a=a(previous)+step*(M(with previous values subbed in)*a(previous)
        f=M.subs({x:x0})*a.subs({y:y0,yp:yp0})
        a=a.subs({y:y0,yp:yp0})+step*f
        y0=a.row(0)[0]
        yp0=a.row(1)[0]
        x0+=step
    return a                                   #returns a 2x1 matrix with the final y value in the first row and the final y prime value in the second row


yfMatrix=EulersSecondOrder(eqn2,0,1,2,0.2,0.1) 

print('yf=',yfMatrix.row(0)[0])
print('yfprime=',yfMatrix.row(1)[0])

